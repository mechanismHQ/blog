"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[87],{3905:function(e,t,i){i.d(t,{Zo:function(){return m},kt:function(){return u}});var n=i(7294);function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function r(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||(o[i]=e[i]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}var s=n.createContext({}),c=function(e){var t=n.useContext(s),i=t;return e&&(i="function"==typeof e?e(t):r(r({},t),e)),i},m=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var i=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),p=c(i),u=o,d=p["".concat(s,".").concat(u)]||p[u]||h[u]||a;return i?n.createElement(d,r(r({ref:t},m),{},{components:i})):n.createElement(d,r({ref:t},m))}));function u(e,t){var i=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=i.length,r=new Array(a);r[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var c=2;c<a;c++)r[c]=i[c];return n.createElement.apply(null,r)}return n.createElement.apply(null,i)}p.displayName="MDXCreateElement"},7162:function(e,t,i){i.r(t),i.d(t,{assets:function(){return m},contentTitle:function(){return s},default:function(){return u},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return h}});var n=i(7462),o=i(3366),a=(i(7294),i(3905)),r=["components"],l={tags:["CityCoins","PoXL","Tokenomics"],sidebar_label:"PoXL ideas (Part 1)",authors:["hank"],hide_table_of_contents:!1,slug:"poxl-proportional-mining-rewards",date:new Date("2022-03-15T00:00:00.000Z")},s="PoXL ideas: Proportional mining rewards",c={permalink:"/poxl-proportional-mining-rewards",source:"@site/blog/2022-03-14-citycoins-1/index.md",title:"PoXL ideas: Proportional mining rewards",description:"In this post, I\u2019d like to make the case for changing how mining rewards in CityCoins (or any PoXL project) are distributed. Currently, mining is a \u201cwinner takes all\u201d model. Instead, I\u2019m advocating for proportional mining rewards.",date:"2022-03-15T00:00:00.000Z",formattedDate:"March 15, 2022",tags:[{label:"CityCoins",permalink:"/tags/city-coins"},{label:"PoXL",permalink:"/tags/po-xl"},{label:"Tokenomics",permalink:"/tags/tokenomics"}],truncated:!0,authors:[{name:"Hank Stoever",twitter:"@heynky",imageURL:"https://github.com/hstove.png",key:"hank"}],frontMatter:{tags:["CityCoins","PoXL","Tokenomics"],sidebar_label:"PoXL ideas (Part 1)",authors:["hank"],hide_table_of_contents:!1,slug:"poxl-proportional-mining-rewards",date:"2022-03-15T00:00:00.000Z"},prevItem:{title:"Using Bitcoin to create a truly decentralized stablecoin",permalink:"/bitcoin-difficulty-stablecoin"},nextItem:{title:"New Clarity functions coming in Stacks 2.1",permalink:"/clarity-2-functions"}},m={authorsImageUrls:[void 0]},h=[{value:"PoXL vs PoX",id:"poxl-vs-pox",level:2},{value:"The difficulty of profitable mining",id:"the-difficulty-of-profitable-mining",level:2},{value:"Cumulative binomial distributions",id:"cumulative-binomial-distributions",level:3},{value:"Proportionally distributed mining rewards",id:"proportionally-distributed-mining-rewards",level:2}],p={toc:h};function u(e){var t=e.components,l=(0,o.Z)(e,r);return(0,a.kt)("wrapper",(0,n.Z)({},p,l,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In this post, I\u2019d like to make the case for changing how mining rewards in CityCoins (or any PoXL project) are distributed. Currently, mining is a \u201cwinner takes all\u201d model. Instead, I\u2019m advocating for ",(0,a.kt)("strong",{parentName:"p"},"proportional mining rewards"),"."),(0,a.kt)("p",null,"The core thesis behind this change is:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Proportional rewards will increase miner participation"),(0,a.kt)("li",{parentName:"ul"},"Increasing miner participation is good for a PoXL project")),(0,a.kt)("h2",{id:"poxl-vs-pox"},"PoXL vs PoX"),(0,a.kt)("p",null,"CityCoin\u2019s mining mechanism, Proof-of-Transfer-Lite (PoXL), is an almost direct port of the Stacks Proof-of-Transfer (PoX) mining mechanism. This has many benefits, but PoX is designed around certain goals that CityCoins do not have. The \u201cwinner takes all\u201d mining reward is one such example that is needed in PoX, but isn\u2019t required in PoXL."),(0,a.kt)("p",null,'Stacks mining requires a "leader election" consensus mechanism. The winning miner is responsible for forming an anchor blocks, as well as for proposing a microblock stream in between anchor blocks. CityCoins does not have any requirements for leader election, so there isn\u2019t a need to have a \u201cwinning miner\u201d.'),(0,a.kt)("h2",{id:"the-difficulty-of-profitable-mining"},"The difficulty of profitable mining"),(0,a.kt)("p",null,"When CityCoins miners participate in mining, many are likely doing so in order to accumulate a project's tokens at a better price than they could receive on the open market."),(0,a.kt)("p",null,"One simple way to calculate mining profitability is to think of it in expected value (EV) terms. If I commit some amount of STX to mine a block, what is the expected value?"),(0,a.kt)("p",null,"PoXL mining is designed such that your probability of winning a block is equal to the proportion of funds you've committed to that block."),(0,a.kt)("p",null,"As an example:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"There are 900 STX committed from miners already"),(0,a.kt)("li",{parentName:"ul"},"The block reward is worth 2000 STX. In CityCoins projects, the block reward is not in STX, but it can be valued in STX."),(0,a.kt)("li",{parentName:"ul"},"Alice commits 100 STX, bringing the total miner commit to 1000 STX")),(0,a.kt)("p",null,"In this example, Alice has a 10% chance of winning the block (because she committed 100 out of 1000 STX). The expected value for Alice is then:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"0.1 * 2000 + 0.9 * 0 = 200 STX\n")),(0,a.kt)("p",null,"According to the EV calculation, Alice's expected value is 200 STX - double what she put in! Most of the time, you want to make an EV bet that 2x's your bid."),(0,a.kt)("p",null,"In reality, Alice will lose 100 STX and get nothing in return 9 times out of 10. In order to have a higher confidence that she'll make money from mining, Alice will need to mine many blocks. So, how many times would Alice need to mine to have a high probability of being +EV?"),(0,a.kt)("h3",{id:"cumulative-binomial-distributions"},"Cumulative binomial distributions"),(0,a.kt)("p",null,"PoXL mining is ",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Binomial_distribution"},"binomial")," - you either win the block or you lose it. Using statistics, we can evaluate this as a ",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Cumulative_distribution_function"},"cumulative distribution function")," to calculate how often a miner will end up profitable if they mine for a certain number of blocks. Now that the fancy words are out of the way, we'll explain what this means."),(0,a.kt)("p",null,"We've created a ",(0,a.kt)("a",{parentName:"p",href:"https://docs.google.com/spreadsheets/d/15ipYxuiMKBAUtat-ojwIS6xM1RoGda6lkpYRpq6QV2g/edit?usp=sharing"},"Google sheet")," that does this math for you. It's pre-populated with a few real-world variables from recently mined MIA blocks."),(0,a.kt)("p",null,"In our calculator, we assume that a miner has a specific amount of STX that they want to spend to mine CityCoins. With that condition, we can evaluate how likely the miner is profitable if they commit ",(0,a.kt)("em",{parentName:"p"},"x")," amount of STX to mining each block."),(0,a.kt)("p",null,"The more STX a miner commits, the higher their chance of winning the block. However, when they spend more STX, they're not able to mine for as many blocks. Additionally, the more STX committed each block, the higher the ",(0,a.kt)("em",{parentName:"p"},"total")," miner commitment is, meaning that miner profitability is lower."),(0,a.kt)("p",null,"With these factors in mind, we can determine that ",(0,a.kt)("strong",{parentName:"p"},"the best strategy for PoXL mining is to mine for many block with as few STX per block as possible.")," The only downside to this strategy is that it will take a while to mine, meaning you'll have less time receiving Stacking rewards, and you'll have to spend more on transaction fees."),(0,a.kt)("p",null,(0,a.kt)("img",{loading:"lazy",alt:"Profitability probability vs. spend",src:i(7518).Z,width:"554",height:"343"})),(0,a.kt)("p",null,"As we can see, there quickly becomes a point where your probability of ending of with profit from mining becomes less than 50%."),(0,a.kt)("p",null,"We can also demonstrate the need to mine for many blocks in order to end up profitable. To visualize this, we can set up a scenario with fixed variables and see how likely it is for a miner to be profitable based on the number of blocks they mined."),(0,a.kt)("p",null,"In this chart, the miner has a 5% chance of winning, and the miner discount is 11%. Because of this discount, the expected value of mining is +11%. However, actually making a profit depends on the number of blocks they mine."),(0,a.kt)("p",null,(0,a.kt)("img",{loading:"lazy",alt:"profit vs blocks mined",src:i(2160).Z,width:"600",height:"371"})),(0,a.kt)("p",null,"As you can see, you need to mine for thousands of blocks in order to be confident that you\u2019ll make any profit at all, even with a high discount."),(0,a.kt)("p",null,"All of this is to show that ",(0,a.kt)("strong",{parentName:"p"},"profitably mining in PoXL is hard and unlikely"),"."),(0,a.kt)("h2",{id:"proportionally-distributed-mining-rewards"},"Proportionally distributed mining rewards"),(0,a.kt)("p",null,'Now that we\'ve outlined the challenges behind "winner takes all" mining, we can look at an alternative - sharing mining rewards proportionally amongst all miners.'),(0,a.kt)("p",null,"In this model, a miner who commits 10% of the total mining commitment would receive 10% of the total mining rewards for that block."),(0,a.kt)("p",null,"The best aspect of this alternative is that ",(0,a.kt)("strong",{parentName:"p"},"it makes profitable mining much easier"),". Remember our previous example? The expected value of Alice's mining action was a 2x return, but in reality she'd lose her whole commitment 90% of the time. In this model, Alice will make her 2x return every single time."),(0,a.kt)("p",null,'By making profitable mining much more likely, our hypothesis is that this will lead to greater involvement in mining. Rational miners will commit to mining as much as possible, up until the point where the total miner commitment is equal to the block reward. In reality, there will likely still be some "miner discount" to account for transaction fees and price variability risk. However, we believe that the net discount will end up being lower in this scheme.'),(0,a.kt)("p",null,"To support the argument that miners are more likely to continue mining as the miner discount gets smaller, we can evaluate a miner's chance of being profitable under these conditions."),(0,a.kt)("p",null,"In the following chart, we evaluate a scenario where a miner is going to mine 10 STX for 500 blocks. Using the same math as before, we can look at the chance that a miner is profitable as the discount approaches zero."),(0,a.kt)("p",null,(0,a.kt)("img",{loading:"lazy",alt:"Profit vs discount",src:i(2752).Z,width:"600",height:"371"})),(0,a.kt)("p",null,"As you can see, once the discount is below 10%, this miner can expect to lose money more than 50% of the time. A rational miner should either not mine, or they should commit to mining for many more blocks."),(0,a.kt)("p",null,"Compare this to proportional mining rewards - ",(0,a.kt)("strong",{parentName:"p"},"this miner will always be profitable as long as the discount is below zero!")),(0,a.kt)("hr",null),(0,a.kt)("p",null,"We hope that this post sheds light on a mechanism change to PoXL and CityCoins that aims to increase miner participation. When more STX are committed to mining, that leads to more Stacking rewards and more funds raised for a City. Ultimately, we hope that these kinds of incremental improvements can help CityCoins and other DAOs to achieve overall success."))}u.isMDXComponent=!0},2160:function(e,t,i){t.Z=i.p+"assets/images/+Profit probability vs. Blocks mined-159154cbc9319fb364e0b47e32de9f32.png"},2752:function(e,t,i){t.Z=i.p+"assets/images/+Profit probability vs. Discount-489cfd3f3a15df7d4c835ae8faf31310.png"},7518:function(e,t,i){t.Z=i.p+"assets/images/+Profit probability vs. STX spent-d2b369270d465b05c9819c98bd31d963.png"}}]);